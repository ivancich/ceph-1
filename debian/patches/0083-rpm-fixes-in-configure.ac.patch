From: Ali Maredia <amaredia@redhat.com>
Date: Wed, 8 Jun 2016 08:47:32 -0400
Subject: rpm: fixes in configure.ac

Resolves: rhbz#1343189
---
 configure.ac | 24 ++++++++++++++----------
 1 file changed, 14 insertions(+), 10 deletions(-)

diff --git a/configure.ac b/configure.ac
index 4038a53..70d00fc 100644
--- a/configure.ac
+++ b/configure.ac
@@ -504,16 +504,20 @@ AC_SUBST(GCOV_PREFIX_STRIP, `echo $(pwd)/src | tr -dc / | wc -c`)
 # is radosgw available?
 RADOSGW=0
 AS_IF([test "x$with_radosgw" != xno],
-             [AC_CHECK_LIB([expat], [XML_Parse],
-              [AC_CHECK_LIB([curl], [curl_easy_init],
-	       [if test "x$with_radosgw" != "xcheck"; then
-		    AC_MSG_FAILURE([--with-radosgw was given but libcurl (libcurl-dev on debian) not found])
-	       fi])
-              ],
-	      [if test "x$with_radosgw" != "xcheck"; then
-		   AC_MSG_FAILURE([--with-radosgw was given but libexpat (libexpat1-dev on debian) not found])
-	      fi])
-             ])
+           [AC_CHECK_LIB([expat], [XML_Parse],
+            [AC_CHECK_LIB([curl], [curl_easy_init],
+             [RADOSGW=1
+              AC_CHECK_HEADER([fastcgi/fcgiapp.h],
+               [AC_DEFINE([FASTCGI_INCLUDE_DIR], [1], [FastCGI headers are in /usr/include/fastcgi])])
+             ],
+             [if test "x$with_radosgw" != "xcheck"; then
+                  AC_MSG_FAILURE([--with-radosgw was given but libcurl (libcurl-dev on debian) not found])
+             fi])
+            ],
+            [if test "x$with_radosgw" != "xcheck"; then
+                 AC_MSG_FAILURE([--with-radosgw was given but libexpat (libexpat1-dev on debian) not found])
+            fi])
+           ])
 AM_CONDITIONAL(WITH_RADOSGW, test "$RADOSGW" = "1")
 
 AS_IF([test "$RADOSGW" = "1"], [AC_DEFINE([WITH_RADOSGW], [1], [define if radosgw enabled])])
