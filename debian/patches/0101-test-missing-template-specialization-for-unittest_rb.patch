From: Jason Dillaman <dillaman@redhat.com>
Date: Tue, 28 Jun 2016 14:59:17 -0400
Subject: test: missing template specialization for unittest_rbd_mirror

Signed-off-by: Jason Dillaman <dillaman@redhat.com>
(cherry picked from commit 187e2c87b50d64e93736a42fcf449c55e8550125)

Resolves: rhbz#1356064
---
 .../image_replayer/test_mock_BootstrapRequest.cc           | 14 ++++++++++++++
 1 file changed, 14 insertions(+)

diff --git a/src/test/rbd_mirror/image_replayer/test_mock_BootstrapRequest.cc b/src/test/rbd_mirror/image_replayer/test_mock_BootstrapRequest.cc
index 7ca0436..3aae98a 100644
--- a/src/test/rbd_mirror/image_replayer/test_mock_BootstrapRequest.cc
+++ b/src/test/rbd_mirror/image_replayer/test_mock_BootstrapRequest.cc
@@ -4,6 +4,7 @@
 #include "test/rbd_mirror/test_mock_fixture.h"
 #include "librbd/journal/TypeTraits.h"
 #include "tools/rbd_mirror/ImageSync.h"
+#include "tools/rbd_mirror/ImageSyncThrottler.h"
 #include "tools/rbd_mirror/image_replayer/BootstrapRequest.h"
 #include "tools/rbd_mirror/image_replayer/CloseImageRequest.h"
 #include "tools/rbd_mirror/image_replayer/CreateImageRequest.h"
@@ -70,6 +71,19 @@ struct ImageSync<librbd::MockTestImageCtx> {
 
 ImageSync<librbd::MockTestImageCtx>* ImageSync<librbd::MockTestImageCtx>::s_instance = nullptr;
 
+template<>
+struct ImageSyncThrottler<librbd::MockTestImageCtx> {
+  MOCK_METHOD10(start_sync, void(librbd::MockTestImageCtx *local_image_ctx,
+                                 librbd::MockTestImageCtx *remote_image_ctx,
+                                 SafeTimer *timer, Mutex *timer_lock,
+                                 const std::string &mirror_uuid,
+                                 ::journal::MockJournaler *journaler,
+                                 librbd::journal::MirrorPeerClientMeta *client_meta,
+                                 ContextWQ *work_queue, Context *on_finish,
+                                 ProgressContext *progress_ctx));
+  MOCK_METHOD1(cancel_sync, void(const std::string& mirror_uuid));
+};
+
 namespace image_replayer {
 
 template<>
