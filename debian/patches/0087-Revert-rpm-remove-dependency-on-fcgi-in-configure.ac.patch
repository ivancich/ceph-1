From: Ali Maredia <amaredia@redhat.com>
Date: Wed, 8 Jun 2016 15:33:21 -0400
Subject: Revert "rpm: remove dependency on fcgi in configure.ac"

This reverts commit 73c29537ad8e0d574967cb16bae7b1124dd9d03b.

Resolves: rhbz#1343189
---
 configure.ac | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/configure.ac b/configure.ac
index 4038a53..cd0c91c 100644
--- a/configure.ac
+++ b/configure.ac
@@ -504,8 +504,13 @@ AC_SUBST(GCOV_PREFIX_STRIP, `echo $(pwd)/src | tr -dc / | wc -c`)
 # is radosgw available?
 RADOSGW=0
 AS_IF([test "x$with_radosgw" != xno],
+	    [AC_CHECK_LIB([fcgi], [FCGX_Init],
              [AC_CHECK_LIB([expat], [XML_Parse],
               [AC_CHECK_LIB([curl], [curl_easy_init],
+               [RADOSGW=1
+	        AC_CHECK_HEADER([fastcgi/fcgiapp.h],
+		 [AC_DEFINE([FASTCGI_INCLUDE_DIR], [1], [FastCGI headers are in /usr/include/fastcgi])])
+	       ],
 	       [if test "x$with_radosgw" != "xcheck"; then
 		    AC_MSG_FAILURE([--with-radosgw was given but libcurl (libcurl-dev on debian) not found])
 	       fi])
@@ -513,7 +518,10 @@ AS_IF([test "x$with_radosgw" != xno],
 	      [if test "x$with_radosgw" != "xcheck"; then
 		   AC_MSG_FAILURE([--with-radosgw was given but libexpat (libexpat1-dev on debian) not found])
 	      fi])
-             ])
+             ],
+	     [if test "x$with_radosgw" != "xcheck"; then
+		AC_MSG_FAILURE([--with-radosgw was given but libfcgi (libfcgi-dev on debian) not found])
+	     fi])])
 AM_CONDITIONAL(WITH_RADOSGW, test "$RADOSGW" = "1")
 
 AS_IF([test "$RADOSGW" = "1"], [AC_DEFINE([WITH_RADOSGW], [1], [define if radosgw enabled])])
