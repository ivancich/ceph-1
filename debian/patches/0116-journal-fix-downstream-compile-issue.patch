From: Jason Dillaman <dillaman@redhat.com>
Date: Wed, 5 Oct 2016 14:28:39 -0400
Subject: journal: fix downstream compile issue

Signed-off-by: Jason Dillaman <dillaman@redhat.com>

Resolves: rhbz#1365648
---
 src/journal/JournalTrimmer.cc | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/journal/JournalTrimmer.cc b/src/journal/JournalTrimmer.cc
index 18b8e38..6612d9f 100644
--- a/src/journal/JournalTrimmer.cc
+++ b/src/journal/JournalTrimmer.cc
@@ -49,7 +49,9 @@ void JournalTrimmer::shut_down(Context *on_finish) {
 
 int JournalTrimmer::remove_objects(bool force) {
   ldout(m_cct, 20) << __func__ << dendl;
-  m_async_op_tracker.wait_for_ops();
+  C_SaferCond ops_ctx;
+  m_async_op_tracker.wait_for_ops(&ops_ctx);
+  ops_ctx.wait();
 
   C_SaferCond ctx;
   {
